# OTUSCppCourseWork
Курсовая работа для курса c++ (otus.ru).

## Тема

Написать многопоточный менеджер задач по расчёту и сохранения матрицы. Расчёт и сохранение происходит построчно.



## Описание

Имеется однопоточный код для расчёта матрицы вещественных чисел.

| Размер задачи (N) | Размер матрицы (NxN), МБ |
| ----------------- | ------------------------ |
| 1024              | 8                        |
| 2048              | 32                       |
| 4096              | 128                      |
| 8192              | 512                      |
| 16384             | 2048                     |
| 32768             | 8192                     |

Существующий однопоточный алгоритм:

- расчёт строчки матрицы
- сохранение её в файл

Особенности:

- расчёт одной строчки не зависит от расчёта других

- расчёт медленнее (в среднем) сохранения

Необходимо расчёт строк матрицы сделать в параллельном режиме. Сохраняться результаты расчёта должны быть в последовательном порядке, т.е. сначала сохраняется 1-я линия, потом 2-я и т.д. (линии не должны быть перемешаны в файле).



## Архитектура

`SimpleTaskCalculator` - "заглушка" (moc) для расчёта строки матрицы. Инициализируется числом строк в матрице. `taskCalculation` - считает `i`-ю строчку матрицы.

```c++
SimpleTaskCalculator
    CalcResult taskCalculation(std::size_t task_num)
    std::size_t getTasksNumber() const
```

`CalcTaskMgr` - многопоточный менеджер задач по расчёту матрицы. Инициализируется расчётчиком матрицы, например, `SimpleTaskCalculator`. `run` - запускает расчёт строк матрицы, рассчитанная строка отправляется всем подписчикам.

```c++
CalcTaskMgr
    CalcTaskMgr(TaskCalculatorHolder task_generator)
    void run()
    void subscribe(SubscriberHolder subscriber)
```

`ResultSaver` - однопоточный менеджер по сохранению строчек в файл. Инициализируется именем файла. Сохраняет строчки с учётом порядка в файл, которые приходит в `update`

```c++
ResultSaver
    void update(ResultHolder calc_result)
```

`CalcResult` - рассчитанная строка матрицы.

```c++
CalcResult
    std::size_t task_num
    std::vector<double> line
```



